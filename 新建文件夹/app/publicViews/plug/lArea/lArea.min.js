window.lArea=function(){var a=function(){this.gearArea,this.data,this.index=0,this.value=[0,0,0]};return a.prototype={init:function(a){this.params=a,this.trigger=document.querySelector(a.trigger),this.bindEvent(a.type),this.callback=a.callback},getData:function(a){var c,b=this;"object"==typeof b.params.data?(b.data=b.params.data,a()):(c=new XMLHttpRequest,c.open("get",b.params.data),c.onload=function(){if(c.status>=200&&c.status<300||0===c.status){var e=JSON.parse(c.responseText);b.data=e.data,a&&a()}},c.send())},bindEvent:function(a){function c(){var c,d,i;b.gearArea=document.createElement("div"),b.gearArea.className="gearArea",b.gearArea.innerHTML='<div class="area_ctrl slideInUp"><div class="area_btn_box"><div class="area_btn larea_cancel">取消</div><div class="area_btn larea_finish">确定</div></div><div class="area_roll_mask"><div class="area_roll"><div><div class="gear area_province" data-areatype="area_province"></div><div class="area_grid"></div></div></div></div></div>',document.body.appendChild(b.gearArea),e(),c=b.gearArea.querySelector(".larea_cancel"),c.addEventListener("touchstart",function(a){b.close(a)}),d=b.gearArea.querySelector(".larea_finish"),d.addEventListener("touchstart",function(a){b.finish(a)}),i=b.gearArea.querySelector(".area_province"),i.addEventListener("touchstart",f),i.addEventListener("touchmove",g),i.addEventListener("touchend",h)}function d(){var c,d,i,j,k;b.gearArea=document.createElement("div"),b.gearArea.className="gearArea",b.gearArea.innerHTML='<div class="area_ctrl slideInUp"><div class="area_btn_box"><div class="area_btn larea_cancel">取消</div><div class="area_btn larea_finish">确定</div></div><div class="area_roll_mask"><div class="area_roll"><div><div class="gear area_province" data-areatype="area_province"></div><div class="area_grid"></div></div><div><div class="gear area_city" data-areatype="area_city"></div><div class="area_grid"></div></div><div><div class="gear area_county" data-areatype="area_county"></div><div class="area_grid"></div></div></div></div></div>',document.body.appendChild(b.gearArea),e(),c=b.gearArea.querySelector(".larea_cancel"),c.addEventListener("touchstart",function(a){b.close(a)}),d=b.gearArea.querySelector(".larea_finish"),d.addEventListener("touchstart",function(a){b.finish(a)}),i=b.gearArea.querySelector(".area_province"),j=b.gearArea.querySelector(".area_city"),k=b.gearArea.querySelector(".area_county"),i.addEventListener("touchstart",f),j.addEventListener("touchstart",f),k.addEventListener("touchstart",f),i.addEventListener("touchmove",g),j.addEventListener("touchmove",g),k.addEventListener("touchmove",g),i.addEventListener("touchend",h),j.addEventListener("touchend",h),k.addEventListener("touchend",h)}function e(){try{b.gearArea.querySelector(".area_province").setAttribute("val",b.value[0])}catch(a){}try{b.gearArea.querySelector(".area_city").setAttribute("val",b.value[1])}catch(a){}try{b.gearArea.querySelector(".area_county").setAttribute("val",b.value[2])}catch(a){}b.setGearTooth(b.data)}function f(a){var b,c;for(a.preventDefault(),b=a.target;;){if(b.classList.contains("gear"))break;b=b.parentElement}clearInterval(b["int_"+b.id]),b["old_"+b.id]=a.targetTouches[0].screenY,b["o_t_"+b.id]=(new Date).getTime(),c=b.getAttribute("top"),b["o_d_"+b.id]=c?parseFloat(c.replace(/em/g,"")):0}function g(a){var b,c;for(a.preventDefault(),b=a.target;;){if(b.classList.contains("gear"))break;b=b.parentElement}b["new_"+b.id]=a.targetTouches[0].screenY,b["n_t_"+b.id]=(new Date).getTime(),c=18*(b["new_"+b.id]-b["old_"+b.id])/370,b["pos_"+b.id]=b["o_d_"+b.id]+c,b.style["-webkit-transform"]="translate3d(0,"+b["pos_"+b.id]+"em,0)",b.setAttribute("top",b["pos_"+b.id]+"em")}function h(a){var b,c;for(a.preventDefault(),b=a.target;;){if(b.classList.contains("gear"))break;b=b.parentElement}c=(b["new_"+b.id]-b["old_"+b.id])/(b["n_t_"+b.id]-b["o_t_"+b.id]),b["spd_"+b.id]=Math.abs(c)<=.2?0>c?-.08:.08:Math.abs(c)<=.5?0>c?-.16:.16:c/2,b["pos_"+b.id]||(b["pos_"+b.id]=0),i(b)}function i(a){var b=0,c=!1;clearInterval(a["int_"+a.id]),a["int_"+a.id]=setInterval(function(){var f,g,h,d=a["pos_"+a.id],e=a["spd_"+a.id]*Math.exp(-.03*b);d+=e,Math.abs(e)>.1||(e=.1,f=2*Math.round(d/2),Math.abs(d-f)<.02?c=!0:d>f?d-=e:d+=e),d>0&&(d=0,c=!0),g=2*-(a.dataset.len-1),g>d&&(d=g,c=!0),c&&(h=Math.abs(d)/2,j(a,h),clearInterval(a["int_"+a.id])),a["pos_"+a.id]=d,a.style["-webkit-transform"]="translate3d(0,"+d+"em,0)",a.setAttribute("top",d+"em"),b++},30)}function j(a,c){c=Math.round(c),a.setAttribute("val",c),b.setGearTooth(b.data)}var b=this;this.type=a,b.getData(function(){"string"===a?b.trigger.addEventListener("click",c):b.trigger.addEventListener("click",d)})},setGearTooth:function(a){var h,i,j,b=this,c=a||[],d=c.length,e=b.gearArea.querySelectorAll(".gear"),f=e[b.index].getAttribute("val");if(e[b.index].setAttribute("data-len",d),d>0){for(c[f].id,h=c[f].child,i="",j=0;d>j;j++)i+="<div class='tooth'  ref='"+c[j].id+"'>"+c[j].name+"</div>";if(e[b.index].innerHTML=i,e[b.index].style["-webkit-transform"]="translate3d(0,"+2*-f+"em,0)",e[b.index].setAttribute("top",2*-f+"em"),b.index++,"string"===this.type)return b.index=0,void 0;if(b.index>2)return b.index=0,void 0;b.setGearTooth(h)}else e[b.index].innerHTML="<div class='tooth'></div>",b.index=0},finish:function(a){var b=this,c=b.gearArea.querySelector(".area_province"),d=b.gearArea.querySelector(".area_city"),e=b.gearArea.querySelector(".area_county"),f="",g="",h="",i="",j="",k="";c&&(f=parseInt(c.getAttribute("val")),g=c.childNodes[f].textContent),d&&(h=parseInt(d.getAttribute("val")),i=d.childNodes[h].textContent),e&&(j=parseInt(e.getAttribute("val")),k=e.childNodes[j].textContent),b.value=[f,h,j],this.callback&&this.callback(b.value),b.close(a)},close:function(a){var b,c;a.preventDefault(),b=this,c=new CustomEvent("input"),b.trigger.dispatchEvent(c),document.body.removeChild(b.gearArea)}},a}();